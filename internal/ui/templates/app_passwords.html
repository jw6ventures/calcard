{{define "content"}}
<h1>App Passwords</h1>
<p>Generate tokens for DAV clients. The plaintext is only shown immediately after creation.</p>
{{if .Plaintext}}
<div class="notice">
    <p><strong>New token:</strong> <code>{{.Plaintext}}</code></p>
    <p>Copy and store it securely; it won't be shown again.</p>
</div>
{{end}}
<table>
    <tr><th>Label</th><th>Created</th><th>Expires</th><th>Last Used</th><th>Status</th><th>Actions</th></tr>
    {{range .AppPasswords}}
    <tr>
        <td>{{.label}}</td>
        <td>{{formatTime .created_at}}</td>
        <td>{{if .expires_at}}{{formatTime .expires_at}}{{else}}none{{end}}</td>
        <td>{{if .last_used}}{{formatTime .last_used}}{{else}}never{{end}}</td>
        <td>{{.status}}</td>
        <td>
            {{if and (eq .status "active") (not .expired)}}
            <form method="post" action="/app-passwords/{{.id}}/revoke">
                <button type="submit">Revoke</button>
            </form>
            {{else}}
            <em>â€”</em>
            {{end}}
        </td>
    </tr>
    {{else}}
    <tr><td colspan="6">No tokens issued yet.</td></tr>
    {{end}}
</table>
<form method="post" action="/app-passwords">
    <h3>Create new token</h3>
    <label>Label <input name="label" required></label>
    <label>Expires At (optional RFC3339) <input name="expires_at"></label>
    <button type="submit">Generate</button>
</form>
{{end}}
{{template "base" .}}
